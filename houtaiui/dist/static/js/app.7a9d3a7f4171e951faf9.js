webpackJsonp([1],{"71T8":function(t,e){},"7gJP":function(t,e){},JLfB:function(t,e){},JrD3:function(t,e){},LicG:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={};a.d(s,"login",function(){return A}),a.d(s,"index",function(){return B}),a.d(s,"allCorp",function(){return N}),a.d(s,"searchCorp",function(){return J}),a.d(s,"tryouts",function(){return q}),a.d(s,"expiringcompanys",function(){return H}),a.d(s,"expiredcompanys",function(){return I}),a.d(s,"newcompanys",function(){return O}),a.d(s,"users",function(){return Z}),a.d(s,"newusers",function(){return W}),a.d(s,"searchUser",function(){return G}),a.d(s,"tourist",function(){return Q}),a.d(s,"configs",function(){return Y}),a.d(s,"editConfigs",function(){return K}),a.d(s,"companymembers",function(){return X}),a.d(s,"companyhosts",function(){return tt}),a.d(s,"companyexpire",function(){return et}),a.d(s,"companymanager",function(){return at}),a.d(s,"updatezabbixserver",function(){return st}),a.d(s,"deleteCorp",function(){return nt}),a.d(s,"disableUser",function(){return it}),a.d(s,"userstopped",function(){return ot}),a.d(s,"deleteUser",function(){return rt}),a.d(s,"admin",function(){return ct});var n=a("7+uW"),i={name:"App",created:function(){!localStorage.getItem("botToken")&&this.$router.replace("/login")}},o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var r=a("VU/8")(i,o,!1,function(t){a("xEfM")},null,null).exports,c=a("/ocq"),l={name:"login",data:function(){return{username:"",password:"",failmsg:"",loading:null}},methods:{check:function(t){var e=this;t.srcElement.blur(),t.target.blur(),this.loading=this.$loading(),this.$axios.login({username:this.username,password:this.password}).then(function(t){if(e.loading.close(),0!=t.status)throw t.msg;localStorage.setItem("botToken",t.token),e.$router.replace("/home")}).catch(function(t){e.loading.close(),e.$message.error(t)})}},created:function(){localStorage.removeItem("botToken")}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"login"}},[a("el-main",[a("div",{staticClass:"main"},[a("div",{staticClass:"login"},[a("div",{staticClass:"title"},[t._v("运维机器人后台")]),t._v(" "),a("div",{staticClass:"username input"},[a("el-input",{attrs:{placeholder:"请输入用户名"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.check(e):null}},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1),t._v(" "),a("div",{staticClass:"password input"},[a("el-input",{attrs:{type:"password",placeholder:"请输入密码"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.check(e):null}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),t._v(" "),a("div",{staticClass:"button"},[a("el-button",{attrs:{type:"primary"},on:{click:t.check}},[t._v("登录")])],1)])])])],1)},staticRenderFns:[]};var p=a("VU/8")(l,u,!1,function(t){a("7gJP")},"data-v-2a13420c",null).exports,d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"reset"}},[a("el-main",[a("div",{staticClass:"main"},[a("div",{staticClass:"login"},[a("div",{staticClass:"username input"},[a("span",[t._v("输入旧密码")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入旧密码"},model:{value:t.oldpassword,callback:function(e){t.oldpassword=e},expression:"oldpassword"}})],1),t._v(" "),a("div",{staticClass:"password input"},[a("span",[t._v("输入新密码")]),t._v(" "),a("el-input",{attrs:{type:"password",placeholder:"请输入新密码"},model:{value:t.newpassword,callback:function(e){t.newpassword=e},expression:"newpassword"}})],1),t._v(" "),a("div",{staticClass:"password input"},[a("span",[t._v("再次输入新密码")]),t._v(" "),a("el-input",{attrs:{type:"password",placeholder:"请输入新密码"},model:{value:t.checkpassword,callback:function(e){t.checkpassword=e},expression:"checkpassword"}})],1),t._v(" "),a("div",{staticClass:"button"},[a("el-button",{attrs:{type:"primary"},on:{click:t.change}},[t._v("修改")])],1)])])])],1)},staticRenderFns:[]};var m=a("VU/8")({name:"reset",data:function(){return{oldpassword:"",newpassword:"",checkpassword:""}},methods:{change:function(){var t=this;if(this.newpassword===this.checkpassword){var e={oldpassword:this.oldpassword,newpassword:this.newpassword};this.loading=this.$loading(),this.$axios.admin(e).then(function(e){t.$router.back(),t.$message({message:"修改成功！",type:"success"})}).catch(this.$message.error).finally(function(){t.loading.close()})}else this.$message.error("两次密码输入不一致！")}},created:function(){}},d,!1,function(t){a("SLme")},"data-v-f8c282a4",null).exports,h={name:"home",data:function(){return{isCollapse:!1}},computed:{path:function(){return this.$route.params.type?this.$route.path.slice(0,-1)+"1":this.$route.path}},methods:{handle:function(t){this[t]()},signout:function(){localStorage.removeItem("botToken"),this.$router.replace("/login")},password:function(){this.$router.push("/reset")},selectPath:function(){}},created:function(){}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"home"}},[a("el-container",[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":t.path,router:"",collapse:t.isCollapse,"background-color":"#2A3F54","text-color":"#fff"},on:{select:t.selectPath}},[a("el-menu-item",{staticClass:"logo",attrs:{index:""}},[a("img",{style:{width:t.isCollapse?"18px":"41px","padding-left":t.isCollapse?"3px":0},attrs:{src:"/static/images/logo.png",alt:""}}),t._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("运维机器人")])]),t._v(" "),a("el-menu-item",{attrs:{index:"/home"}},[a("div",{staticClass:"el-icon-home"},[a("img",{attrs:{src:"/static/images/home.png",alt:""}})]),t._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("后台首页")])]),t._v(" "),a("el-menu-item",{attrs:{index:"/home/company/1"}},[a("div",{staticClass:"el-icon-home"},[a("img",{attrs:{src:"/static/images/corp.png",alt:""}})]),t._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("公司管理")])]),t._v(" "),a("el-menu-item",{attrs:{index:"/home/user/1"}},[a("div",{staticClass:"el-icon-home"},[a("img",{attrs:{src:"/static/images/user.png",alt:""}})]),t._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("用户管理")])]),t._v(" "),a("el-menu-item",{attrs:{index:"/home/setting"}},[a("div",{staticClass:"el-icon-home"},[a("img",{attrs:{src:"/static/images/set.png",alt:""}})]),t._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("参数设置")])])],1),t._v(" "),a("el-main",[a("el-header",[a("div",{staticClass:"header"},[a("div",{staticClass:"collapse",attrs:{alt:""},on:{click:function(e){t.isCollapse=!t.isCollapse}}}),t._v(" "),a("div",{staticClass:"user"},[a("el-dropdown",{on:{command:t.handle}},[a("span",{staticClass:"el-dropdown-link"},[t._v("\n                超级管理员"),a("i",{staticClass:"el-icon-caret-bottom",staticStyle:{color:"#32c5d2"}})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"signout"}},[t._v("退出登录")]),t._v(" "),a("el-dropdown-item",{attrs:{command:"password",divided:""}},[t._v("修改密码")])],1)],1)],1)])]),t._v(" "),a("el-main",[a("router-view")],1)],1)],1)],1)},staticRenderFns:[]};var f=a("VU/8")(h,v,!1,function(t){a("skq/")},"data-v-3d5c6e16",null).exports,g={name:"backend",data:function(){return{info:{}}},methods:{},created:function(){var t=this;this.$axios.index().then(function(e){"Object"===Object.prototype.toString.call(e).slice(8,-1)&&(t.info=e)}).catch(this.$message.error)}},b={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"backend"}},[a("div",{staticClass:"container"},[a("router-link",{staticClass:"item",attrs:{tag:"div",to:"/home/company/5"}},[a("div",{staticClass:"count"},[t._v(t._s(t.info.new_companys))]),t._v(" "),a("div",{staticClass:"title"},[t._v("今日新增公司")])]),t._v(" "),a("router-link",{staticClass:"item",attrs:{tag:"div",to:"/home/company/3"}},[a("div",{staticClass:"count"},[t._v(t._s(t.info.expiring_companys))]),t._v(" "),a("div",{staticClass:"title"},[t._v("即将到期公司")])]),t._v(" "),a("router-link",{staticClass:"item",attrs:{tag:"div",to:"/home/company/2"}},[a("div",{staticClass:"count"},[t._v(t._s(t.info.try_companys))]),t._v(" "),a("div",{staticClass:"title"},[t._v("试用期中的公司")])]),t._v(" "),a("router-link",{staticClass:"item",attrs:{tag:"div",to:"/home/company/1"}},[a("div",{staticClass:"count"},[t._v(t._s(t.info.total_companys))]),t._v(" "),a("div",{staticClass:"title"},[t._v("公司总数量")])]),t._v(" "),a("router-link",{staticClass:"item",attrs:{tag:"div",to:"/home/user/5"}},[a("div",{staticClass:"count"},[t._v(t._s(t.info.new_users))]),t._v(" "),a("div",{staticClass:"title"},[t._v("今日新增用户")])]),t._v(" "),a("router-link",{staticClass:"item",attrs:{tag:"div",to:"/home/user/1"}},[a("div",{staticClass:"count"},[t._v(t._s(t.info.total_users))]),t._v(" "),a("div",{staticClass:"title"},[t._v("用户总数量")])])],1)])},staticRenderFns:[]};var _=a("VU/8")(g,b,!1,function(t){a("wiob")},"data-v-7d6bcbcc",null).exports,y=a("Dd8w"),x=a.n(y),k=a("aozt"),w=a.n(k),C={name:"company",data:function(){return{loading:null,search:"",type:"1",dialogFormVisible:!1,formLabelWidth:"120px",cur:NaN,page:1,pagetotal:1,list:[],dialog:{isShow:!1,show:2,page:1,dialogList:[],companyname:"",inamount:"",totalamount:"",pagetotal:1},temp:{},lastTime:null,cancel:null,zabbix:{show:!1}}},computed:{nav:function(){switch(this.$route.params.type){case"1":return"所有公司";case"2":return"试用期中的公司";case"3":return"即将到期公司";case"4":return"已过期公司";case"5":return"今日新增公司";case"6":return"查询结果"}}},methods:{goSearch:function(){this.search&&(this.$router.push("/home/company/6"),this.searchData())},searchData:function(){var t=this;this.list=[];var e={page:this.page};this.cancelToken(),this.$axios.searchCorp(x()({},e,{name:this.search}),{cancelToken:this.cancel.token}).then(function(e){t.list=e.companyinfo}).catch(this.reject)},deleteConfirm:function(t,e){var a=this;this.$confirm("是否继续删除该公司?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.deleteRow(t,e)})},deleteRow:function(t,e){var a=this,s={companyname:e[t].companyname};this.loading=this.$loading(),this.$axios.deleteCorp(s).then(function(s){a.$message({message:"删除成功！",type:"success"}),e.splice(t,1)}).catch(this.reject).finally(function(){a.loading.close()})},edit:function(t){this.cur=t,this.temp=x()({},this.list[this.cur]),this.temp.oldcompanyname=this.temp.companyname,this.dialogFormVisible=!0},editZabbix:function(t){this.cur=t,this.zabbix=x()({},this.list[this.cur],{show:!0})},submit:function(){var t=this,e={oldcompanyname:this.temp.oldcompanyname,newcompanyname:this.temp.companyname,companyemail:this.temp.adminemail,mark:this.temp.companymark,disable:this.temp.disable};this.loading=this.$loading(),this.$axios.companymanager(e).then(function(e){t.$set(t.list,t.cur,x()({},t.temp,e.companyinfo)),t.dialogFormVisible=!1,t.$message({message:"提交成功！",type:"success"})}).catch(this.$message.error).finally(function(){t.loading.close()})},submitZabbix:function(){var t=this,e={companyid:this.zabbix.companyid||"",zabbixid:this.zabbix.zabbixid||"",zabbixserver:this.zabbix.zabbixserver||"",zabbixusername:this.zabbix.zabbixusername||"",zabbixpassword:this.zabbix.zabbixpassword||""};this.loading=this.$loading(),this.$axios.updatezabbixserver(e).then(function(e){t.zabbix.show=!1,t.$set(t.list,t.cur,x()({},t.zabbix)),t.$message({message:"提交成功！",type:"success"})}).catch(this.$message.error).finally(function(){t.loading.close()})},change:function(){this.init()},dialogChange:function(t,e){var a=this;this.dialog.companyname=t,this.dialog.dialogList=[],e&&(this.dialog.show=e);var s=1===this.dialog.show?this.$axios.companymembers:this.$axios.companyhosts,n={companyname:t,page:this.dialog.page};this.dialog.isShow=!0,s(n).then(function(t){a.dialog.dialogList=1===a.dialog.show?t.userinfo:t.totalhosts,a.dialog.inamount=t.inamount,a.dialog.totalamount=t.totalamount,a.dialog.pagetotal=Math.ceil(t.pagetotal)}).catch(this.$message.error)},closeDialog:function(t){this.dialog.isShow=!1,this.dialog.companyname="",this.dialog.page=1,t()},pickTime:function(t){var e=this;t.companyexpire+=86399e3;var a={companyname:t.companyname,expiredate:t.companyexpire};this.loading=this.$loading(),this.$axios.companyexpire(a).then(function(t){e.$message({message:"修改成功！",type:"success"})}).catch(function(a){t.companyexpire=e.lastTime,e.$message.error(a)}).finally(function(){e.loading.close()})},reject:function(t){"string"==typeof t&&this.$message.error(t)},cancelToken:function(){this.cancel&&this.cancel.cancel("在调用接口之前先取消之前调用响应还没回来的接口"),this.cancel=w.a.CancelToken.source()},init:function(){var t=this;this.list=[];var e={page:this.page},a=function(e){t.list=e.companyinfo,t.pagetotal=e.pagetotal};switch(this.cancelToken(),this.type){case"1":this.$axios.allCorp(e,{cancelToken:this.cancel.token}).then(a).catch(this.reject);break;case"2":this.$axios.tryouts(e,{cancelToken:this.cancel.token}).then(a).catch(this.reject);break;case"3":this.$axios.expiringcompanys(e,{cancelToken:this.cancel.token}).then(a).catch(this.reject);break;case"4":this.$axios.expiredcompanys(e,{cancelToken:this.cancel.token}).then(a).catch(this.reject);break;case"5":this.$axios.newcompanys(e,{cancelToken:this.cancel.token}).then(a).catch(this.reject)}},format:function(t,e){return"正常使用中"===t.expirestring||"即将到期"===t.expirestring?this.$formatTime(t.companyexpire,"-").split(" ")[0]:t.expirestring},oprole:function(t,e){switch(t.userallinfo.oprole){case"3":return"运维人员";case"4":return"管理员与审核员";case"6":return"审核员"}},userstatus:function(t){switch(t){case"register":return"已关联";case"manual":return"未关联"}}},created:function(){this.type=this.$route.params.type,this.page=1,this.init()},beforeRouteUpdate:function(t,e,a){this.type=t.params.type,this.page=1,"6"!=this.type&&this.init(),a()}},$={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"company"}},[a("div",{staticClass:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{staticClass:"first",attrs:{to:{path:"/home/company/1"}}},[t._v("公司管理")]),t._v(" "),"1"!=t.$route.params.type?a("el-breadcrumb-item",[t._v(t._s(t.nav))]):t._e()],1)],1),t._v(" "),a("div",{staticClass:"handle"},[1==t.$route.params.type||6==t.$route.params.type?a("div",{staticClass:"search"},[a("span",[t._v("公司名称")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入查询内容"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.goSearch}},[t._v("查询")])],1):t._e(),t._v(" "),1==t.$route.params.type?a("div",{staticClass:"select"},[a("el-radio-group",{attrs:{fill:"#1ABC9C"},on:{change:function(e){t.$router.push("/home/company/"+t.type)}},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[a("el-radio-button",{attrs:{label:"1"}},[t._v("所有公司")]),t._v(" "),a("el-radio-button",{attrs:{label:"2"}},[t._v("试用")]),t._v(" "),a("el-radio-button",{attrs:{label:"3"}},[t._v("即将到期")]),t._v(" "),a("el-radio-button",{attrs:{label:"4"}},[t._v("已过期")])],1)],1):t._e()]),t._v(" "),a("div",{staticClass:"table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,border:""}},[a("el-table-column",{attrs:{prop:"companyname",label:"公司名称",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"adminusername",label:"管理员姓名",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"adminmobile",label:"手机号码",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"adminemail",label:"邮箱",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"companyexpire",label:"到期时间",formatter:t.format,align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"members",label:"人员",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"handle",on:{click:function(a){t.dialogChange(e.row.companyname,1)}}},[t._v(t._s(e.row.members))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"totalhost",label:"服务器数量",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"handle",on:{click:function(a){t.dialogChange(e.row.companyname,2)}}},[t._v(t._s(e.row.totalhost))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"companymark",label:"备注",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"members",label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-date-picker",{attrs:{type:"date",format:"yyyy-MM-dd ","value-format":"timestamp",editable:!1},on:{change:function(a){t.pickTime(e.row)}},nativeOn:{click:function(a){t.lastTime=e.row.companyexpire}},model:{value:e.row.companyexpire,callback:function(a){t.$set(e.row,"companyexpire",a)},expression:"scope.row.companyexpire"}}),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.edit(e.$index)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.deleteConfirm(e.$index,t.list)}}},[t._v("删除")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"true"===e.row.zabbix_exist,expression:"scope.row.zabbix_exist === 'true'"}],attrs:{type:"text",size:"small"},on:{click:function(a){t.editZabbix(e.$index)}}},[t._v("zabbix服务器配置")])]}}])})],1)],1),t._v(" "),a("el-pagination",{staticClass:"pagination",attrs:{layout:"prev, pager, next","prev-text":"上一页","next-text":"下一页","page-count":t.pagetotal,"current-page":t.page},on:{"update:currentPage":function(e){t.page=e},"current-change":t.change}}),t._v(" "),a("el-dialog",{attrs:{title:"编辑公司",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("div",{staticClass:"content"},[a("div",{staticClass:"company-name item"},[a("span",[t._v("公司名称：")]),t._v(" "),a("el-input",{staticClass:"name",attrs:{placeholder:"请输入内容"},model:{value:t.temp.companyname,callback:function(e){t.$set(t.temp,"companyname",e)},expression:"temp.companyname"}})],1),t._v(" "),a("div",{staticClass:"company-emai item"},[a("span",[t._v("公司邮箱：")]),t._v(" "),a("el-input",{staticClass:"name",attrs:{placeholder:"请输入内容"},model:{value:t.temp.adminemail,callback:function(e){t.$set(t.temp,"adminemail",e)},expression:"temp.adminemail"}})],1),t._v(" "),a("div",{staticClass:"company-emai item"},[a("span",[t._v("备注：")]),t._v(" "),a("el-input",{staticClass:"name",attrs:{type:"textarea",rows:5,placeholder:"请输入内容"},model:{value:t.temp.companymark,callback:function(e){t.$set(t.temp,"companymark",e)},expression:"temp.companymark"}})],1),t._v(" "),a("div",{staticClass:"company-emai item"},[a("span",[t._v("公司状态：")]),t._v(" "),a("div",{staticClass:"name"},[a("el-radio",{attrs:{label:!1},model:{value:t.temp.disable,callback:function(e){t.$set(t.temp,"disable",e)},expression:"temp.disable"}},[t._v("启用")]),t._v(" "),a("el-radio",{attrs:{label:!0},model:{value:t.temp.disable,callback:function(e){t.$set(t.temp,"disable",e)},expression:"temp.disable"}},[t._v("停用")])],1)])]),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("提 交")])],1)]),t._v(" "),a("el-dialog",{attrs:{title:"zabbix服务器配置",visible:t.zabbix.show},on:{"update:visible":function(e){t.$set(t.zabbix,"show",e)}}},[a("div",{staticClass:"content"},[a("div",{staticClass:"company-name item"},[a("span",[t._v("公司id：")]),t._v(" "),a("div",{staticClass:"name"},[t._v(t._s(t.list[t.cur]&&t.list[t.cur].companyid))])]),t._v(" "),a("div",{staticClass:"company-emai item"},[a("span",[t._v("服务器id：")]),t._v(" "),a("el-input",{staticClass:"name",attrs:{placeholder:"请输入内容"},model:{value:t.zabbix.zabbixid,callback:function(e){t.$set(t.zabbix,"zabbixid",e)},expression:"zabbix.zabbixid"}})],1),t._v(" "),a("div",{staticClass:"company-emai item"},[a("span",[t._v("服务器地址：")]),t._v(" "),a("el-input",{staticClass:"name",attrs:{placeholder:"请输入内容"},model:{value:t.zabbix.zabbixserver,callback:function(e){t.$set(t.zabbix,"zabbixserver",e)},expression:"zabbix.zabbixserver"}})],1),t._v(" "),a("div",{staticClass:"company-emai item"},[a("span",[t._v("用户名：")]),t._v(" "),a("el-input",{staticClass:"name",attrs:{placeholder:"请输入内容"},model:{value:t.zabbix.zabbixusername,callback:function(e){t.$set(t.zabbix,"zabbixusername",e)},expression:"zabbix.zabbixusername"}})],1),t._v(" "),a("div",{staticClass:"company-emai item"},[a("span",[t._v("密码：")]),t._v(" "),a("el-input",{staticClass:"name",attrs:{type:"password",placeholder:"请输入内容"},model:{value:t.zabbix.zabbixpassword,callback:function(e){t.$set(t.zabbix,"zabbixpassword",e)},expression:"zabbix.zabbixpassword"}})],1)]),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.zabbix.show=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.submitZabbix}},[t._v("保 存")])],1)]),t._v(" "),a("el-dialog",{attrs:{title:1===t.dialog.show?"公司运维人员":"公司服务器数量("+(t.dialog.monitoramount||"")+"/"+(t.dialog.totalamount||"")+")","before-close":t.closeDialog,visible:t.dialog.isShow},on:{"update:visible":function(e){t.$set(t.dialog,"isShow",e)}}},[a("div",{staticClass:"content"},[1===t.dialog.show?[a("el-table",{key:"1",staticStyle:{width:"100%"},attrs:{data:t.dialog.dialogList,border:"",height:"350px"}},[a("el-table-column",{attrs:{prop:"userallinfo.username",label:"姓名",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"userallinfo.mobile",label:"手机号码",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"userallinfo.oprole",label:"权限",align:"center",formatter:t.oprole}}),t._v(" "),a("el-table-column",{attrs:{prop:"userallinfo.userstatus",label:"是否和账号关联",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"userstatus",style:{color:"register"===e.row.userallinfo.userstatus?"green":"#606266"}},[t._v(t._s(t.userstatus(e.row.userallinfo.userstatus)))])]}}])})],1)]:t._e(),t._v(" "),2===t.dialog.show?[a("el-table",{key:"2",staticStyle:{width:"100%"},attrs:{data:t.dialog.dialogList,border:"",height:"350px"}},[a("el-table-column",{attrs:{prop:"name",label:"服务器名称",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"host",label:"服务器IP地址",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Hoststatus",label:"监控服务器",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"userstatus",style:{color:"in"===e.row.Hoststatus?"green":"#606266"}},[t._v(t._s("in"===e.row.Hoststatus?"是":"否"))])]}}])})],1)]:t._e()],2),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-pagination",{staticClass:"pagination",attrs:{layout:"prev, pager, next","prev-text":"上一页","next-text":"下一页","page-count":t.dialog.pagetotal,"current-page":t.dialog.page},on:{"update:currentPage":function(e){t.$set(t.dialog,"page",e)},"current-change":function(e){t.dialogChange(t.dialog.companyname)}}})],1)])],1)},staticRenderFns:[]};var z=a("VU/8")(C,$,!1,function(t){a("JrD3")},"data-v-079413d2",null).exports,T={name:"user",data:function(){return{search:{companyname:"",mobile:""},type:"1",dialogFormVisible:!1,formLabelWidth:"120px",cur:NaN,page:1,pagetotal:1,list:[],temp:{},cancel:null}},computed:{nav:function(){switch(this.$route.params.type){case"1":return"所有用户";case"2":return"未关联公司";case"3":return"停用";case"5":return"今日新增用户";case"6":return"查询结果"}}},methods:{goSearch:function(){this.$router.push("/home/user/6"),this.searchData()},searchData:function(){var t=this;this.list=[];var e={page:this.page};this.cancelToken(),this.$axios.searchUser(x()({},e,this.search),{cancelToken:this.cancel.token}).then(function(e){t.list=e.userinfo,t.list.forEach(function(e){e.userallinfo.logintime=t.$formatTime(e.userallinfo.logintime).replace(/\//g,"-")})}).catch(this.reject)},deleteConfirm:function(t,e){var a=this;this.$confirm("是否继续删除该用户?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.deleteRow(t,e)})},deleteRow:function(t,e){var a=this,s={userid:e[t].userallinfo.userid,companyid:e[t].companyid||""};this.loading=this.$loading(),this.$axios.deleteUser(s).then(function(s){a.$message({message:"删除成功！",type:"success"}),e.splice(t,1)}).catch(this.reject).finally(function(){a.loading.close()})},disableUser:function(t){var e=this,a=t.row.userallinfo,s="userdisabled"===a.mark?"userenabled":"userdisabled",n={userdisable:s,userid:a.userid,companyid:t.row.companyid||""};this.loading=this.$loading(),this.$axios.disableUser(n).then(function(n){e.$message({message:"userdisabled"===s?"禁用成功":"启用成功",type:"success"}),a.mark=s,e.$set(e.list,t.$index,e.list[t.$index])}).catch(this.$message.error).finally(function(){e.loading.close()})},change:function(){this.init()},reject:function(t){"string"==typeof t&&this.$message.error(t)},cancelToken:function(){this.cancel&&this.cancel.cancel("在调用接口之前先取消之前调用响应还没回来的接口"),this.cancel=w.a.CancelToken.source()},init:function(){var t=this;this.list=[];var e={page:this.page},a=function(e){t.list=e.userinfo,t.pagetotal=e.pagetotal,t.list.forEach(function(e){e.userallinfo.logintime=t.$formatTime(e.userallinfo.logintime).replace(/\//g,"-")})};switch(this.cancelToken(),this.type){case"1":this.$axios.users(e,{cancelToken:this.cancel.token}).then(a).catch(this.reject);break;case"2":this.$axios.tourist(e,{cancelToken:this.cancel.token}).then(a).catch(this.reject);break;case"3":this.$axios.userstopped(e,{cancelToken:this.cancel.token}).then(a).catch(this.reject);break;case"5":this.$axios.newusers(e,{cancelToken:this.cancel.token}).then(a).catch(this.reject)}}},created:function(){this.type=this.$route.params.type,this.page=1,this.init()},beforeRouteUpdate:function(t,e,a){this.type=t.params.type,this.page=1,"6"!=this.type&&this.init(),a()}},S={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"user"}},[a("div",{staticClass:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{staticClass:"first",attrs:{to:{path:"/home/user/1"}}},[t._v("用户管理")]),t._v(" "),"1"!=t.$route.params.type?a("el-breadcrumb-item",[t._v(t._s(t.nav))]):t._e()],1)],1),t._v(" "),a("div",{staticClass:"handle"},[1==t.$route.params.type||6==t.$route.params.type?a("div",{staticClass:"search"},[a("span",[t._v("公司名称")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入公司名称"},model:{value:t.search.companyname,callback:function(e){t.$set(t.search,"companyname",e)},expression:"search.companyname"}}),t._v(" "),a("span",[t._v("手机号")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:t.search.mobile,callback:function(e){t.$set(t.search,"mobile",e)},expression:"search.mobile"}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.goSearch}},[t._v("查询")])],1):t._e(),t._v(" "),1==t.$route.params.type?a("div",{staticClass:"select"},[a("el-radio-group",{attrs:{fill:"#1ABC9C"},on:{change:function(e){t.$router.push("/home/user/"+t.type)}},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[a("el-radio-button",{attrs:{label:"1"}},[t._v("所有用户")]),t._v(" "),a("el-radio-button",{attrs:{label:"2"}},[t._v("未关联公司")]),t._v(" "),a("el-radio-button",{attrs:{label:"3"}},[t._v("停用")])],1)],1):t._e()]),t._v(" "),a("div",{staticClass:"table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,border:""}},[a("el-table-column",{attrs:{prop:"companyname",label:"所属公司",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"userallinfo.username",label:"用户姓名",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"userallinfo.mobile",label:"手机号码",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"userallinfo.logintime",label:"上次登录",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"userallinfo.mark",label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"userstatus",style:{color:"userdisabled"===e.row.userallinfo.mark?"red":"#606266"}},[t._v(t._s("userdisabled"===e.row.userallinfo.mark?"停用":"启用"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"members",label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.disableUser(e)}}},[t._v(t._s("userdisabled"===e.row.userallinfo.mark?"启用":"禁用"))]),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.deleteConfirm(e.$index,t.list)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),a("el-pagination",{staticClass:"pagination",attrs:{layout:"prev, pager, next","prev-text":"上一页","next-text":"下一页","page-count":t.pagetotal,"current-page":t.page},on:{"update:currentPage":function(e){t.page=e},"current-change":t.change}})],1)},staticRenderFns:[]};var j=a("VU/8")(T,S,!1,function(t){a("JLfB")},"data-v-e4dce72a",null).exports,U={name:"setting",data:function(){return{expire:0,customerservice:"",loading:null}},methods:{submit:function(){var t=this,e={expire:this.expire,customerservice:this.customerservice};this.loading=this.$loading(),this.$axios.editConfigs(e).then(function(e){if(0!=e.status)throw e.msg;t.loading.close(),t.$message({message:"保存成功！",type:"success"})}).catch(function(e){t.loading.close(),console.log(e),t.$message.error(e)})},init:function(){var t=this;this.$axios.configs().then(function(e){t.expire=e.expire,t.customerservice=e.customerservice}).catch(this.$message.error)}},created:function(){this.init()}},F={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"setting"}},[a("div",{staticClass:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{staticClass:"first"},[t._v("参数设置")])],1)],1),t._v(" "),a("div",{staticClass:"handle"},[a("div",{staticClass:"title"},[t._v("设置产品各种参数或数据")]),t._v(" "),a("div",{staticClass:"form"},[a("div",[a("span",{staticClass:"question"},[t._v("正式使用的产品到期提前多少天提醒？")]),t._v(" "),a("div",{staticClass:"right"},[a("el-input",{attrs:{type:"number",placeholder:"请输入天数"},model:{value:t.expire,callback:function(e){t.expire=e},expression:"expire"}}),t._v(" "),a("span",[t._v("天")])],1)]),t._v(" "),a("div",[a("span",{staticClass:"question"},[t._v("客服电话")]),t._v(" "),a("div",{staticClass:"right"},[a("el-input",{staticClass:"phone",attrs:{type:"tel",placeholder:"请输入客服电话"},model:{value:t.customerservice,callback:function(e){t.customerservice=e},expression:"customerservice"}})],1)])])]),t._v(" "),a("div",{staticClass:"button"},[a("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("保存")])],1)])},staticRenderFns:[]};var E=a("VU/8")(U,F,!1,function(t){a("iLAv")},"data-v-ebf9656a",null).exports;n.default.use(c.a);var L=new c.a({routes:[{path:"/",redirect:"/home"},{path:"/home",component:f,children:[{path:"",component:_},{path:"company/:type",component:z},{path:"user/:type",component:j},{path:"setting",component:E}]},{path:"/login",component:p},{path:"/reset",component:m}]}),R={render:function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"mask"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:this.showMask,expression:"showMask"}],staticClass:"loading"},[e("img",{attrs:{src:"/static/images/loading@2x.png",alt:""}})])])},staticRenderFns:[]};var V=a("VU/8")({name:"loading",data:function(){return{showMask:!1}},methods:{show:function(){this.showMask=!0},hide:function(){this.showMask=!1}}},R,!1,function(t){a("71T8")},"data-v-32a55efd",null).exports,M=a("//Fk"),D=a.n(M),P=w.a.create({baseURL:"http://61.139.64.108:18080"});function A(t){return P.post("/backstage/login",t).then(function(t){return t.data})}function B(t){return P.get("/backstage/index",{params:{}}).then(function(t){return t.data})}function N(t,e){return P.get("/backstage/companymanages",x()({params:t},e)).then(function(t){return t.data})}function J(t,e){return P.get("/backstage/companymanage/"+t.name+"?page="+t.page,x()({params:{}},e)).then(function(t){return t.data})}function q(t,e){return P.get("/backstage/tryouts",x()({params:t},e)).then(function(t){return t.data})}function H(t,e){return P.get("/backstage/expiringcompanys",x()({params:t},e)).then(function(t){return t.data})}function I(t,e){return P.get("/backstage/expiredcompanys",x()({params:t},e)).then(function(t){return t.data})}function O(t,e){return P.get("/backstage/newcompanys",x()({params:t},e)).then(function(t){return t.data})}function Z(t,e){return P.get("/backstage/users",x()({params:t},e)).then(function(t){return t.data})}function W(t,e){return P.get("/backstage/newusers",x()({params:t},e)).then(function(t){return t.data})}function G(t,e){return P.get("/backstage/usersearch",x()({params:t},e)).then(function(t){return t.data})}function Q(t,e){return P.get("/backstage/tourist",x()({params:t},e)).then(function(t){return t.data})}function Y(t){return P.get("/backstage/configs",{params:{}}).then(function(t){return t.data})}function K(t){return P.post("/backstage/configs",t).then(function(t){return t.data})}function X(t){return P.get("/backstage/companymembers",{params:t}).then(function(t){return t.data})}function tt(t){return P.get("/backstage/companyhosts",{params:t}).then(function(t){return t.data})}function et(t){return P.patch("/backstage/companyexpire",t).then(function(t){return t.data})}function at(t){return P.patch("/backstage/companymanager",t).then(function(t){return t.data})}function st(t){return P.patch("/backstage/updatezabbixserver",t).then(function(t){return t.data})}function nt(t){return P.delete("/backstage/companymanager",{params:t}).then(function(t){return t.data})}function it(t){return P.patch("/backstage/user",t).then(function(t){return t.data})}function ot(t,e){return P.get("/backstage/userstopped",x()({params:t},e)).then(function(t){return t.data})}function rt(t){return P.delete("/backstage/user",{params:t}).then(function(t){return t.data})}function ct(t){return P.patch("/backstage/admin",t).then(function(t){return t.data})}P.interceptors.request.use(function(t){var e=localStorage.getItem("botToken");return!e&&L.replace("/login"),"get"!==t.method&&"delete"!==t.method||(t.params.token=e),"post"!==t.method&&"patch"!==t.method||(t.data.token=e),t},function(t){return D.a.reject(t)}),P.interceptors.response.use(function(t){return 1==t.data.status&&L.push("/login"),t.data.status&&0!=t.data.status?(console.log(t.data.msg),D.a.reject(t.data.msg)):t},function(t){return mt.$message.error(t.response.statusText),D.a.reject(t)});var lt=s,ut={install:function(t,e){t.extend(V);t.prototype.$getQueryString=function(t){var e=new RegExp("(^|&)"+name+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(e);return null!==a?unescape(a[2]):null},t.prototype.$formatTime=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/";if(!t)return"";var a=new Date(t),s=a.getFullYear(),n=a.getMonth()+1,i=a.getDate(),o=a.getHours(),r=a.getMinutes(),c=a.getSeconds();return""+s+e+(n>9?n:"0"+n)+e+(i>9?i:"0"+i)+" "+(o>9?o:"0"+o)+":"+(r>9?r:"0"+r)+":"+(c>9?c:"0"+c)},t.prototype.$axios=lt}},pt=a("DVuL"),dt=a.n(pt);a("LicG");n.default.use(dt.a),n.default.use(ut),n.default.config.productionTip=!1;var mt=e.default=new n.default({el:"#app",router:L,components:{App:r},template:"<App/>"})},SLme:function(t,e){},iLAv:function(t,e){},"skq/":function(t,e){},wiob:function(t,e){},xEfM:function(t,e){}},["NHnr"]);